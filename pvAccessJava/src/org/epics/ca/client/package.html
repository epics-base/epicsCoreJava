<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>EPICS Java Channel Access Version 4: client</title>
</head>

<body>
<h1 style="text-align: center">EPICS Java Channel Access Version 4: client<br
/>
package: org/epics/ca/client<br />
2010.08.26</h1>
CONTENTS 

<div class="toc">
<ul>
  <li><a href="#Overview">Overview</a></li>
  <li><a href="#Example">Example</a>
    <ul>
      <li><a href="#What">What the example does</a></li>
      <li><a href="#Example1">Example Source</a>
        <ul>
          <li><a href="#main">main</a></li>
          <li><a href="#Implementa">Implementation of channel get
          client</a></li>
          <li><a href="#ChannelReq">ChannelRequester methods.</a></li>
          <li><a href="#ChannelGet">ChannelGetRequester methods:</a></li>
          <li><a href="#Requester">Requester methods:</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#Starting">Starting Channel Access</a></li>
  <li><a href="#ChannelAcc">ChannelAccess, and ChannelProvider</a>
    <ul>
      <li><a href="#ChannelAcc1">ChannelAccessFactory</a></li>
      <li><a href="#ChannelAcc2">ChannelAccess</a></li>
      <li><a href="#ChannelPro">ChannelProvider</a></li>
      <li><a href="#ChannelFin">ChannelFind</a></li>
      <li><a href="#Query">Query</a></li>
    </ul>
  </li>
  <li><a href="#Channel">Channel</a></li>
  <li><a href="#AccessRigh">AccessRights</a></li>
  <li><a href="#Query1">Query</a></li>
  <li><a href="#GetField">GetField</a></li>
  <li><a href="#ChannelReq1">ChannelRequest</a>
    <ul>
      <li><a href="#PVStructur">PVStructure pvRequest</a></li>
      <li><a href="#CreateRequ">CreateRequestFactory.createRequest</a></li>
      <li><a href="#Examples">Examples</a>
        <ul>
          <li><a href="#Simple">Simple example</a></li>
          <li><a href="#Power">Power Supply Example</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#ChannelPro1">ChannelProcess</a></li>
  <li><a href="#ChannelGet1">ChannelGet</a></li>
  <li><a href="#ChannelPut">ChannelPut</a></li>
  <li><a href="#ChannelPut1">ChannelPutGet</a></li>
  <li><a href="#ChannelRPC">ChannelRPC</a></li>
  <li><a href="#ChannelArr">ChannelArray</a></li>
  <li><a href="#Monitor">Monitor</a></li>
</ul>
</div>
<hr />

<h2 style="text-align: center" id="Overview">Overview</h2>
<hr />

<p>This package defines the client interfaces for pvAccess, which is a
version of channel access that fully supports structured data as defined by
PVData. It is assumed that the reader understands PVData, which is
implemented by the eclipse project "org.epics.pvData". </p>

<p>A Channel provides a communication path beween a client and a PVRecord. A
channel access server, which must reside in the same process as the PVRecord,
provides access to the record. The client and server can be part of the same
process or can be in different processes on the same network node or on
different network nodes. Channel Access provides the connection between the
client and server.</p>

<p>A client creates a channel via a call to ChannelProvider.createChannel. A
ChannelProvider is located via a call to ChannelAccess.getProvider.
ChannelAccess is located via ChannelAccessFactory.</p>

<p>This overview discusses:</p>
<ul>
  <li>An example client.</li>
  <li>How to connect to a channel provider.</li>
  <li>An overview of all the client interfaces..</li>
</ul>

<p>Many of the methods described below return or have a argument Status. This
is defined in project pvData as follows:</p>
<pre>interface Status extends Serializable {
    public enum StatusType {OK,WARNING,ERROR,FATAL}
    StatusType getType();
    String getMessage();
    String getStackDump();
    boolean isOK();
    boolean isSuccess();
}</pre>

<p>Unless isSuccess is true the client must realize that the request failed.
When a failure occurs, other arguments may be null.</p>
<hr />

<h2 style="text-align: center" id="Example">Example</h2>
<hr />

<h3 id="What">What the example does</h3>

<p>This section shows an example of issuing a channel get request. the
example is a java main program that can be executed as follows:</p>
<pre>java org.epics.ca.client.example.ExampleChannelGet  channelName request</pre>

<p>For example if the arguments are:</p>
<pre>    scalarCounter value</pre>

<p>The output is:</p>
<pre>structure example
{
    value = 8
}</pre>

<p>If the arguments are: </p>
<pre>    scalarCounter value,alarm,timeStamp</pre>

<p>The output is:</p>
<pre>structure example
{
    value = 5
    alarm = structure
    {
        severity = structure
        {
            index = 0
            choices = [none,minor,major,invalid]
        }
        message = null
        ackTransient = false
        ackSeverity = structure
        {
            index = 0
            choices = [none,minor,major,invalid]
        }
    }
    timeStamp = structure
    {
        secondsPastEpoch = 1253549456
        nanoSeconds = 478000000
    }
}</pre>

<p>If the request is not given then the entire record is shown.</p>

<h3 id="Example1">Example Source</h3>

<h4 id="main">main</h4>
<pre>public class ExampleChannelGet {
    public static void main(String[] args) throws CAException {
        org.epics.ca.ClientFactory.start();
        int len = args.length;
        if(len&lt;1 || len&gt;2 || (len==1 &amp;&amp; args[0].equals("?"))) {
            System.out.println("Usage: channelName request");
            return;
        }
        String channelName = args[0];
        String request = null;
        if(len==2) {
            request = args[1];
        }
       
        Client client = new Client(channelName,request);
        for(int i=0; i&lt;10; i++) {
            if(client.isDone()) break;
            try {
                System.out.println("waiting");
                Thread.sleep(1000);
            } catch (Throwable th) {
                th.printStackTrace();
            }
        }
    }

    private static final String providerName = "pvAccess";
    private static final ChannelAccess channelAccess = ChannelAccessFactory.getChannelAccess();
    private static final PVDataCreate pvDataCreate = PVDataFactory.getPVDataCreate();</pre>

<p>The main routine first checks for valid arguments, creates an instance of
Client, which is shown below, and then waits for up to ten seconds until
Client has obtained data.</p>

<h4 id="Implementa">Implementation of channel get client</h4>
<pre>    private static class Client implements ChannelRequester, ChannelGetRequester {

        Client(String channelName,String request) {
            if(request==null) {
                pvRequest = pvDataCreate.createPVStructure(null, "example", new Field[0]);
            } else {
                pvRequest = CreateRequestFactory.createRequest(request);
            }
            channelProvider = channelAccess.getProvider(providerName);
            channelProvider.createChannel(channelName, this, ChannelProvider.PRIORITY_DEFAULT);
        }

        private ChannelProvider channelProvider = null;
        private Channel channel = null;
        private ChannelGet channelGet = null;
        private PVStructure pvStructure = null;
        private BitSet bitSet = null;
        private PVStructure pvRequest = null;
        private boolean done = false;

        boolean isDone() {return done;}</pre>

<p>The above is the constructor and private data. The constructor creates a
channel. This will result in a call to channelCreated and, if succesful, a
call to channelStateChange.</p>

<h4 id="ChannelReq">ChannelRequester methods.</h4>
<pre>        public void channelCreated(Status status, Channel channel) {
            if(!status.isSuccess()) {
                message("channelCreated " + status.getMessage(),MessageType.error);
                done = true;
                return;
            }
            this.channel = channel;
        }

        public void channelStateChange(Channel c,ConnectionState connectionState) {
            if(connectionState==ConnectionState.CONNECTED) {
                this.channel = c;
                channelGet = channel.createChannelGet(this, pvRequest);
            } else {
                message(connectionState.name(),MessageType.error);
                done = true;
            }
        }</pre>

<p><span style="font-family: Courier">channelCreated</span> just checks
status and saves the reference to the channel. <span
style="font-family: Courier">channelStateChange</span> calls <span
style="font-family: Courier">createChannelGet</span> when the channel
connects. This will result in a call to <span
style="font-family: Courier">channelGetConnect</span> . </p>

<h4 id="ChannelGet">ChannelGetRequester methods:</h4>
<pre>        public void channelGetConnect(Status status, ChannelGet channelGet,PVStructure pvStructure, BitSet bitSet) {
            if(!status.isSuccess()) {
                message("channelGetConnect " + status.getMessage(),MessageType.error);
                done = true;
                return;
            }
            synchronized(this) {
                this.channelGet = channelGet;
                this.pvStructure = pvStructure;
                this.bitSet = bitSet;
            }
            channelGet.get(true);
        }

        public void getDone(Status status) {
            if(!status.isSuccess()) {
                message("getDone " + status.getMessage(),MessageType.error);
                done = true;
                return;
            }
            message(pvStructure.toString(),MessageType.info);
            done = true;
        }</pre>

<p><span style="font-family: Courier">channelGetConnect</span> issues a get
request, specifying that it is the last request. A client can issue multiple
get requsts for each ChannelGet but for a particular channelGet a new get
request must not be issued until <span
style="font-family: Courier">getDone</span> is called. <span
style="font-family: Courier">getDone</span> is called as a result of a get
request.</p>

<h4 id="Requester">Requester methods:</h4>
<pre>        public String getRequesterName() {
            return "example";
        }

        public void message(String message, MessageType messageType) {
            if(messageType!=MessageType.info) {
                System.err.println(messageType.toString() + " " + message);
            } else {
                System.out.println(message);
            }
        }

    }
}</pre>

<p>These two methods are defined by project pvData.</p>
<hr />

<h2 style="text-align: center" id="Starting">Starting Channel Access</h2>
<hr />

<p>Before using channel access, the appropriate support must be started. Each
support is started by calling the start method of a factory that starts the
support. For example the client side of network based channel access is
started by calling:</p>
<pre>    org.epics.ca.ClientFactory.start();</pre>

<p>Package org.epics.ca provides the following factories:</p>
<dl>
  <dt><span style="font-family: Courier">ClientFactory</span></dt>
    <dd>This starts the client side of the network support for pvAccess. This
      is the only support that needs to be started by a stand-alone client.
      The example shown in the previous section calls this.</dd>
  <dt><span style="font-family: Courier">LocalFactory</span></dt>
    <dd>This is called for accessing a local PVDatabase. It is also required
      by the ServerFactory and must be started before the server factory. An
      application that wants to use channel access to access the local
      database must start this. For example the JavaIOC starts this.</dd>
  <dt><span style="font-family: Courier">ServerFactory</span></dt>
    <dd>This must be started in order to allow pvAccess clients to access the
      local PVDatabase. For example the javaIOC can start this.</dd>
</dl>

<p>The javaIOC provides factories for starting the gateway code between caV3
and pvAccess. The factories are located in package org.epics.ioc.caV3 and are
named:</p>
<dl>
  <dt><span style="font-family: Courier">ClientFactory</span></dt>
    <dd>The code that allows a pvAccess client to commuinicate with an epiocs
      V3 IOC.</dd>
  <dt><span style="font-family: Courier">ServerFactory</span></dt>
    <dd>The code that allows an epics V3 channel access client to access the
      local PVDatabase.</dd>
</dl>
<hr />

<h2 style="text-align: center" id="ChannelAcc">ChannelAccess, and
ChannelProvider</h2>
<hr />

<p>In order to connect to a channel a client must:</p>
<ol>
  <li>Call ChannelAccessFactory to get the ChannelAccess interface.</li>
  <li>Call ChannelAccess to get a ChannelProvider.</li>
  <li>Call channelProvider to create a Channel.</li>
</ol>

<p>A client must know the channel name and the name of the channel provider.
For PVData the channel name is just a record name. This project (CAJv4)
implements the following channel providers: local and pvAccess. The javaIOC
eclipse project provides support for version 3 channel access. See it for
details. </p>

<h3 id="ChannelAcc1">ChannelAccessFactory</h3>

<p>Class org.epics.ca.client.ChannelAccessFactory has the following public
methods:</p>
<pre>public class ChannelAccessFactory {
    public static ChannelAccess getChannelAccess();
    public static void registerChannelProvider(ChannelProvider channelProvider);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">getChannelAccess</span></dt>
    <dd>Gets the ChannelAccess interface described next.</dd>
  <dt><span style="font-family: Courier">registerChannelProvider</span></dt>
    <dd>Registers a channel provider. Typical providers are local, pvAccess
      and caV3. This is called by channel providers not by user code.</dd>
</dl>

<h3 id="ChannelAcc2">ChannelAccess</h3>
<pre>interface ChannelAccess {
    ChannelProvider getProvider(String providerName);
    String[] getProviderNames();
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">getProvider</span></dt>
    <dd>Get the provider with the specified name. A null is returned if no
      provider with that name has been registered.</dd>
  <dt><span style="font-family: Courier">getProviderNames</span></dt>
    <dd>Get the names of all the registered providers.</dd>
</dl>

<h3 id="ChannelPro">ChannelProvider</h3>
<pre>interface ChannelProvider {
    static final public short PRIORITY_MIN = 0;
    static final public short PRIORITY_MAX = 99;
    static final public short PRIORITY_LINKS_DB = PRIORITY_MAX;
    static final public short PRIORITY_ARCHIVE = (PRIORITY_MAX + PRIORITY_MIN) / 2;
    static final public short PRIORITY_OPI = PRIORITY_MIN;

    void destroy();
    String getProviderName();
    ChannelFind channelFind(String channelName,ChannelFindRequester channelFindRequester);
    Query query(PVField query, QueryRequester queryRequester);
    void createChannel(String channelName, channelRequester,short priority);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">destroy</span></dt>
    <dd>The channel provider will shutdown and remove all resources it is
      using.</dd>
  <dt><span style="font-family: Courier">getProviderName</span></dt>
    <dd>Get the name of the provider.</dd>
  <dt><span style="font-family: Courier">channelFind</span></dt>
    <dd>Find a channel. The details are described in this section.</dd>
  <dt><span style="font-family: Courier">createChannel</span></dt>
    <dd>Create a channel. A Channel is described in the next section.</dd>
</dl>

<h3 id="ChannelFin">ChannelFind</h3>

<p>A client can determine if a channel exists without creating a channel. The
client must implement a requester interface and the implentation provides an
interface that the client can use to cancel the request. The interfaces
are:</p>
<pre>interface ChannelFindRequester {
    void channelFindResult(Status status,ChannelFind channelFind,boolean wasFound);
}

interface ChannelFind {
     ChannelProvider getChannelProvider();
     void cancelChannelFind();
} </pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelFindResult</span></dt>
    <dd>This is called by the implementation. It may or may not get called.
      For a remote call it is normally called only if the channel is found. A
      local provider will usually call it immediately and report if it has
      the requested channel. Thus this can be called before the channelFind
      method returns.</dd>
  <dt><span style="font-family: Courier">getChannelProvider</span></dt>
    <dd>Get the channel provider.</dd>
  <dt><span style="font-family: Courier">cancelChannelFind</span></dt>
    <dd>Cancel the find request.</dd>
</dl>

<h3 id="Query">Query</h3>

<p>This is described in a later section.</p>
<hr />

<h2 style="text-align: center" id="Channel">Channel</h2>
<hr />

<p>The Channel interface provides access to the services a channel access
provider implements for a channel. The principal services are: process, get,
put, putGet,array, and monitor. Each of these and some other services are
described in later sections of this package overview.</p>

<p>As described in the previous section a Channel is created via a call to
the method:</p>
<pre>    ChannelProvider.createChannel(String channelName,ChannelRequester channelRequester)</pre>

<p>The caller must implement the interface:</p>
<pre>interface ChannelRequester extends Requester {
    void channelCreated(Status status,Channel channel);
    void channelStateChange(Channel c,ConnectionState connectionState);
    void destroy(Channel c);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">Requester</span></dt>
    <dd>This is defined in package org.epics.pvdata.pv. It has two methods:
      getRequesterName and message.</dd>
  <dt><span style="font-family: Courier">channelCreated</span></dt>
    <dd>This is called when a channel has been created. The argument provides
      the channel unless status was not success.</dd>
  <dt><span style="font-family: Courier">channelStateChange</span></dt>
    <dd>A channel connection state change has occured. This called the first
      time when a channel has been created and connected to a server.</dd>
  <dt><span style="font-family: Courier">destroy</span></dt>
    <dd>This is called if the channel is being terminated for some reason.
      The requester will no longer be able to make requests of the
    channel.</dd>
</dl>

<p>The Channel interface is:</p>
<pre>interface Channel extends Requester{
    public enum ConnectionState {
         NEVER_CONNECTED, CONNECTED, DISCONNECTED, DESTROYED
    };

    ChannelProvider getProvider();
    String getRemoteAddress();
    ConnectionState getConnectionState();
    void destroy();
    String getChannelName();
    ChannelRequester getChannelRequester();
    boolean isConnected();
    AccessRights getAccessRights(PVField pvField);
    void getField(GetFieldRequester requester,String subField);
    ChannelProcess createChannelProcess(
        ChannelProcessRequester channelProcessRequester,
        PVStructure pvOption);
    ChannelGet createChannelGet(
        ChannelGetRequester channelGetRequester,
        PVStructure pvRequest);
    ChannelPut createChannelPut(
        ChannelPutRequester channelPutRequester,
        PVStructure pvRequest);
    ChannelPutGet createChannelPutGet(
        ChannelPutGetRequester channelPutGetRequester,
        PVStructure pvRequest);
    ChannelRPC createChannelRPC(
        ChannelRPCRequester channelRPCRequester,
        PVStructure pvRequest);
    ChannelArray createChannelArray(
        ChannelArrayRequester channelArrayRequester,
        PVStructure pvRequest);
    Monitor createMonitor(
        MonitorRequester MonitorRequester,
        PVStructure pvRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">getProvider</span></dt>
    <dd>Get the provider.</dd>
  <dt><span style="font-family: Courier">getRemoteAddress</span></dt>
    <dd>Get the network address of the server.</dd>
  <dt><span style="font-family: Courier">destroy</span></dt>
    <dd>Destroy the channel and all resources used by the channel.</dd>
  <dt><span style="font-family: Courier">getChannelName</span></dt>
    <dd>The name of the channel. For cav4 this is the name if the
    PVRecord.</dd>
  <dt><span style="font-family: Courier">getChannelRequester</span></dt>
    <dd>Get the channel requester. This is normally called by the
      implementation rather than the client.</dd>
  <dt><span style="font-family: Courier">isConnected</span></dt>
    <dd>Is the channel connected?</dd>
  <dt><span style="font-family: Courier">getAccessRights</span></dt>
    <dd>Get the access rights for the channel.</dd>
</dl>

<p>The remaining methods are described in later sections of this package
overview.</p>
<hr />

<h2 style="text-align: center" id="AccessRigh">AccessRights</h2>
<hr />

<p>Access Rights are not currently implemented.</p>
<pre>enum AccessRights {
    none,
    read,
    readWrite
}</pre>
<hr />

<h2 style="text-align: center" id="Query1">Query</h2>
<hr />

<p>A query is a request that spans IOCs. For example a query might be "get
the names of all the BPMs". The interfaces are:</p>
<pre>interface Query {
     ChannelProvider getChannelProvider();
     void cancelQuery();
}

interface QueryRequester {
    void queryResult(Status status, Query query, PVField result);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">getChannelProvider</span></dt>
    <dd>Get the channel provider.</dd>
  <dt><span style="font-family: Courier">cancelQuery</span></dt>
    <dd>Cancel the request.</dd>
  <dt><span style="font-family: Courier">queryResult</span></dt>
    <dd>The result of the queue request,</dd>
</dl>
<hr />

<h2 style="text-align: center" id="GetField">GetField</h2>
<hr />

<p>MATEJ There is no way to cancel the request.</p>

<p>The method:</p>
<pre>    Channel.getField(GetFieldRequester requester,String subField);</pre>

<p>Gets the introspection interface for the specified sub field of the record
it which the channel is connected. The subField can be null, which means get
the introspection interface for the entire record, or is of the form
"name.name..." . Thus it can be a request for any field within a record. The
requester must implement the interface:</p>
<pre>interface GetFieldRequester extends Requester {
    void getDone(Status status,Field field);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">getDone</span></dt>
    <dd>A getField request has finished. A null is returned if the request
      fails. If the request succeeds Field is the introspection
    interface.</dd>
</dl>
<hr />

<h2 style="text-align: center" id="ChannelReq1">ChannelRequest</h2>
<hr />

<p>Many of the interfaces described in later sections extend the following
interface.</p>
<pre>interface ChannelRequest extends Destroyable {}</pre>

<p>where Destroyable has the single method:</p>
<dl>
  <dt><span style="font-family: Courier">destroy</span></dt>
    <dd>Destroy whatever the extended interface implements. It will free all
      resources it uses.</dd>
</dl>

<p>Many of the interface described in the later sections are created via a
create call that has as one of it's arguments:</p>
<pre>       PVStructure pvRequest</pre>

<p>A request structure is defined in package org.epics.ioc.pvCopy but, for
convenience part is repeated here.</p>

<h3 id="PVStructur">PVStructure pvRequest</h3>

<p>This is a PVStructure that describes the fields and options in PVRecord
that are to be accessed. The format is defined by org.epics.pvData.pvCopy.
See the package overview for details.</p>

<h3 id="CreateRequ">CreateRequestFactory.createRequest</h3>

<p>This package provides the following factory:</p>
<pre>class CreateRequestFactory {
    public static PVStructure createRequest(String request,Requester requester);
}</pre>

<p>This creates a request structure. See the package documentation for
org.epics.iov.pvCopy/package.html for a detailed description.A few examples
are repeaed here. </p>

<h3 id="Examples">Examples</h3>

<p>The following examples are for either a simple record or for a power
supply record. These are records that have one of the following
structures:</p>
<pre>simpleRecord
    value
    alarm
    timeStamp
    display
    .. other fields like input, etc

powerSupply
    alarm
    timeStamp
    power
       value
       alarm
       .. other fields
    voltage
       value
       alarm
       .. other fields
    current
       value
       alarm
       .. other fields
    .. other fields</pre>

<h4 id="Simple">Simple example</h4>

<p>The following creates a request for three fields: alarm, timeStamp, and
power.value</p>
<pre>    PVStructure pvRequest = CreateRequestFactory.createRequest("alarm,timeStamp,power.value");</pre>

<p>The PVStructure holding data for the requester will have the structure:</p>
<pre> pvData
     alarm           // from record.alarm
     timeStamp       // from record.timeStamp
     value           // from record.value</pre>

<p>Note that if the actual record does not have a requested field than that
field will not be present in the structure returned to the client.</p>

<h4 id="Power">Power Supply Example</h4>

<p>The following creates a request for alarm, timeStamp, power, current, and
voltage. Power, current, and voltage will each be a structure with two
fields: value and alarm.</p>
<pre>    PVStructure pvRequest = CreateRequestFactory.createRequest(
       "alarm,timeStamp"
       + ",power{power.value,power.alarm}"
       + ",current{current.value,current.alarm}"
       + ",voltage{voltage.value,voltage.alarm}");</pre>

<p>The resulting structure that appears to the client has the form:</p>
<pre>pvData
   alarm          // from record.alarm
   timeStamp      // from record.timeStamp
   power          // appears because of pvRequest
      value       // from record.power.value
      alarm       // from record.power.alarm
   current        // appears because of pvRequest
      value       // from record.current.value
      alarm       // from record.current.alar.
   voltage        // appears because of pvRequest
      value       // from record.voltage.value
      alarm       // from record.voltage.alarm</pre>
<hr />

<h2 style="text-align: center" id="ChannelPro1">ChannelProcess</h2>
<hr />

<p>A ChannelProcess is created via a call to:</p>
<pre>interface Channel extends Requester{
   ChannelProcess createChannelProcess(
       ChannelProcessRequester channelProcessRequester);
}</pre>

<p>The requester must implement the interface:</p>
<pre>interface ChannelProcessRequester extends Requester {
    void channelProcessConnect(Status status,ChannelProcess channelProcess);
    void processDone(Status status);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelProcessConnect</span></dt>
    <dd>This returns the interface for requesting that a record be processed.
      Status is the result for the create request. channelProcess is null if
      status is not success.</dd>
  <dt><span style="font-family: Courier">processDone</span></dt>
    <dd>This is called when a process request is done. Status is the result
      for the process request. </dd>
</dl>

<p>The following is the interface for requesting that a record be
processed.</p>
<pre>interface ChannelProcess extends ChannelRequest {
    void process(boolean lastRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">process</span></dt>
    <dd>Process the record. If lastRequest is true than it is a one time
      request, i.e. it is the same as calling destroy after the process is
      complete.</dd>
</dl>
<hr />

<h2 style="text-align: center" id="ChannelGet1">ChannelGet</h2>
<hr />

<p>A ChannelGet is created via a call to:</p>
<pre>interface Channel extends Requester{
    ChannelGet createChannelGet(ChannelGetRequester channelGetRequester,PVStructure pvRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelGetRequester</span></dt>
    <dd>Described next.</dd>
  <dt><span style="font-family: Courier">pvRequest</span></dt>
    <dd>This was described in a previous section. BUT for channelGet the
      request string for CreateRequestFactory.createRequest has the form:
      "record[options]field(fieldOptions)". An example of a record options is
      "process=true". The fieldOptions are as defined by pvCopy.</dd>
</dl>

<p>The requester must implement the interface.</p>
<pre>interface ChannelGetRequester extends Requester {
    void channelGetConnect(Status status,ChannelGet channelGet,PVStructure pvStructure,BitSet bitSet);
    void getDone(Status status);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelGetConnect</span></dt>
    <dd>This is called if the createProcess fails or when the client request
      is connected to the server. Status provides the result of the
      createChannel request. If status is not success than the other
      arguments are null. channelGet is the interface for requesting gets.
      All data will be returned in pvStructure. bitSet shows which fields
      have new data. If a bit of bitSet is set for a structure field that
      means that all fields of the structure have new values. For example of
      bit 0 of bitSet is set then all fields of pvStructure have new data.
      Note that each PVField implements a method getFieldOffset(). this can
      be used with bitSet to determine which fields have new data values. See
      BitSet and PVField in org.epics.pvData for details.</dd>
  <dt><span style="font-family: Courier">getDone</span></dt>
    <dd>The get request is done. status provides the result of the get
      request. If successful the pvStructure and bitSet returned by the call
      to channelGetConnect contain the data.</dd>
</dl>

<p>The following is the interface for requesting data from a record.</p>
<pre>interface ChannelGet extends ChannelRequest {
    void get(boolean lastRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">get</span></dt>
    <dd>Get data. If lastRequest is true than it is a one time request, i.e.
      it is the same as calling destroy after the get is complete.</dd>
</dl>
<hr />

<h2 style="text-align: center" id="ChannelPut">ChannelPut</h2>
<hr />

<p>A ChannelPut is created via a call to:</p>
<pre>interface Channel extends Requester{
    ChannelPut createChannelPut(ChannelPutRequester channelPutRequester,PVStructure pvRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelPutRequester</span></dt>
    <dd>Described next.</dd>
  <dt><span style="font-family: Courier">pvRequest</span></dt>
    <dd>This was described in a previous section. BUT for channelPut the
      request string for CreateRequestFactory.createRequest has the form:
      "record[options]field(fieldOptions)". An example of a record options is
      "process=true". The fieldOptions are as defined by pvCopy.</dd>
</dl>

<p>The requester must implement the interface.</p>
<pre>interface ChannelPutRequester extends Requester {
    void channelPutConnect(Status status,ChannelPut channelPut,PVStructure pvStructure,BitSet bitSet);
    void putDone(Status status);
    void getDone(Status status);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelPutConnect</span></dt>
    <dd>This is called if the createChannelPut fails or when the client
      request is connected to the server. Status provides the result of the
      createChannelPut request. If status is not success than the other
      arguments are null. channelPut is the interface for requesting puts and
      gets. The caller puts data into pvStructure pvStructure and sets bits
      in bitSet to shows which fields have new data before making a put
      request. If a bit of bitSet is set for a structure field that means
      that all fields of the structure have new values. For example of bit 0
      of bitSet is set then all fields of pvStructure have new data. Note
      that each PVField implements a method getFieldOffset(). this can be
      used with bitSet to determine which fields have new data values. See
      BitSet and PVField in org.epics.pvData for details.</dd>
  <dt><span style="font-family: Courier">putDone</span></dt>
    <dd>The put request is done. status provides the result of the put
      request. </dd>
  <dt><span style="font-family: Courier">getDone</span></dt>
    <dd>The get request is done. status provides the result of the put
      request. </dd>
</dl>

<p>The following is the interface for requesting data from a record.</p>
<pre>interface ChannelPut extends ChannelRequest {
    void put(boolean lastRequest);
    void get();
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">put</span></dt>
    <dd>Put data. If lastRequest is true than it is a one time request, i.e.
      it is the same as calling destroy after the put is complete.</dd>
  <dt><span style="font-family: Courier">get</span></dt>
    <dd>Get the current data from the record. The record is never processed.
      The request just gets the current values which is put into the
      pvStructure returned in the call to channelPutConnect.</dd>
</dl>
<hr />

<h2 style="text-align: center" id="ChannelPut1">ChannelPutGet</h2>
<hr />

<p>A channelPutGet request puts data into a record, optionally processes the
record, and gets data from the record.</p>

<p>A channel putGet is created via a call to:</p>
<pre>ChannelPutGet createChannelPutGet(ChannelPutGetRequester channelPutGetRequester,PVStructure pvRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelPutGetRequester</span></dt>
    <dd>Described next.</dd>
  <dt><span style="font-family: Courier">pvPutRequest</span></dt>
    <dd>This was described in a previous section. BUT for channelPutGet the
      request string for CreateRequestFactory.createRequest has the form:
      "record[process=true]putField(fieldOptions)getField(fieldOptions)". An
      example of a record options is "process=true". The fieldOptions are as
      defined by pvCopy.</dd>
</dl>

<p>The requester must implement the interface.</p>
<pre>interface ChannelPutGetRequester extends Requester {
    void channelPutGetConnect(Status status,ChannelPutGet channelPutGet,
            PVStructure pvPutStructure,PVStructure pvGetStructure);
    void putGetDone(Status status);
    void getPutDone(Status status);
    void getGetDone(Status status);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelPutGetConnect</span></dt>
    <dd>This is called if the createChannelPutGet fails or when the client
      request is connected to the server. Status provides the result of the
      createChannelPutGet request. If status is not success than the other
      arguments are null. channelPutGet is the interface for requesting
      putGet, getPut and getGet. pvPutStructure holds the put data and
      pvGetStructure holds the get data. </dd>
  <dt><span style="font-family: Courier">putGetDone</span></dt>
    <dd>The putGet request is done.</dd>
  <dt><span style="font-family: Courier">getPutDone</span></dt>
    <dd>The getPut request is done.</dd>
  <dt><span style="font-family: Courier">getGetDone</span></dt>
    <dd>The getGet request is done.</dd>
</dl>

<p>The following is the interface for requesting data from a record.</p>
<pre>interface ChannelPutGet extends ChannelRequest {
    void putGet(boolean lastRequest);
    void getPut();
    void getGet();
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">putGet</span></dt>
    <dd>First put the pvPutStructure data into the record. Then if process is
      true process the record. Finally get data from the record and put it
      into pvGetStructure. If lastRequest is true than it is a one time
      request, i.e. it is the same as calling destroy after the putGet is
      complete.</dd>
  <dt><span style="font-family: Courier">getPut</span></dt>
    <dd>Get current data from the record and put it into pvPutStructure. The
      record is never processed. The request just gets the current values
      which is put into the pvPutStructure returned in the call to
      channelPutGetConnect.</dd>
  <dt><span style="font-family: Courier">getGet</span></dt>
    <dd>Get current data from the record and put it into pvGetStructure. The
      record is never processed. The request just gets the current values
      which is put into the pvGetStructure returned in the call to
      channelPutGetConnect.</dd>
</dl>
<hr />

<h2 style="text-align: center" id="ChannelRPC">ChannelRPC</h2>
<hr />

<p>A ChannelRPC is like a putProcessGet except that a completly different
PVStructure can be returned for each request. It is created via a call to:</p>
<pre>interface Channel extends Requester{
    ChannelRPC createChannelRPC(ChannelRPCRequester channelRPCRequester,PVStructure pvRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelRPCRequester</span></dt>
    <dd>Described next.</dd>
  <dt><span style="font-family: Courier">pvRequest</span></dt>
    <dd>This was described in a previous section. BUT for channelRPC the
      request string for CreateRequest.createRequest has the form:
      "record[options]field(fieldOptions)". Normally no record options are
      entered. The fieldOptions are as defined by pvCopy.</dd>
</dl>

<p>The requester must implement the interface.</p>
<pre>interface ChannelRPCRequester extends Requester {
    void channelRPCConnect(Status status,ChannelRPC channelGet,PVStructure pvStructure,BitSet bitSet);
    void requestDone(Status status,PVStructure pvResponse);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelRPCConnect</span></dt>
    <dd>Status provides the result of the createChannelRPC request. If status
      is not success than the other arguments are null. channelGet is the
      interface for requesting gets. All data will be returned in
      pvStructure. bitSet shows which fields have new data. If a bit of
      bitSet is set for a structure field that means that all fields of the
      structure have new values. For example of bit 0 of bitSet is set then
      all fields of pvStructure have new data. Note that each PVField
      implements a method getFieldOffset(). this can be used with bitSet to
      determine which fields have new data values. See BitSet and PVField in
      org.epics.pvData for details.</dd>
  <dt><span style="font-family: Courier">requestDone</span></dt>
    <dd>The request is done. status provides the result of the request. If
      successful a pvStructure is returned. </dd>
</dl>

<p>The following is the interface for requesting data from a record.</p>
<pre>interface ChannelGet extends ChannelRequest {
    void request(boolean lastRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">request</span></dt>
    <dd>If lastRequest is true than it is a one time request, i.e. Send it is
      the same as calling destroy after the request is complete.</dd>
</dl>
<hr />

<h2 style="text-align: center" id="ChannelArr">ChannelArray</h2>
<hr />

<p>ChannelArray provides the ability to read or write a sub-array of an array
field in a record. Note that all the other transfer methods can also read or
write arrays but always transfer entire arrays. ChannelArray provides the
ability to transfer a subarray. A ChannelArray is created via a call to:</p>
<pre>interface Channel extends Requester{
    ChannelArray createChannelArray(
        ChannelArrayRequester channelArrayRequester,
        PVStructure pvRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelArrayRequester</span></dt>
    <dd>Described next.</dd>
  <dt><span style="font-family: Courier">pvRequest</span></dt>
    <dd>This must be a PVStructure created as follows: 
      <pre>PVStructure pvRequest = pvDataCreate.createPVStructure(null, "", new Field[0]);
PVString pvFieldName = (PVString)pvDataCreate.createPVScalar(pvRequest, "field", ScalarType.pvString);
pvFieldName.put(subField);
pvRequest.appendPVField(pvFieldName);</pre>
    </dd>
</dl>

<p>The requester must implement the interface.</p>
<pre>interface ChannelArrayRequester extends Requester {
    void channelArrayConnect(Status status,ChannelArray channelArray,PVArray pvArray);
    void putArrayDone(Status status);
    void getArrayDone(Status status);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">channelArrayConnect</span></dt>
    <dd>This is called if the createChannelArray fails or when the client
      request is connected to the server. Status provides the result of the
      createChannelArray request. If status is not success than the other
      arguments are null. channelArray is the interface for requesting puts
      and gets. pvArray holds the data to put or get.</dd>
  <dt><span style="font-family: Courier">putArrayDone</span></dt>
    <dd>The put request is done.</dd>
  <dt><span style="font-family: Courier">getArrayDone</span></dt>
    <dd>The get request is done.</dd>
</dl>

<p>The following is the interface for getting or putting array data from a
record.</p>
<pre>interface ChannelArray extends ChannelRequest{
    void putArray(boolean lastRequest, int offset, int count);
    void getArray(boolean lastRequest, int offset, int count);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">putArray</span></dt>
    <dd>Put array data. The offset is the offset in the server and the count
      is the total number of elements to write. If lastRequest is true than
      it is a one time request, i.e. it is the same as calling destroy after
      the put is complete.</dd>
  <dt><span style="font-family: Courier">getArray</span></dt>
    <dd>Get array data. The offset is the offset in the server and the count
      is the total number of elements to read. If lastRequest is true than it
      is a one time request, i.e. it is the same as calling destroy after the
      get is complete.</dd>
</dl>
<hr />

<h2 style="text-align: center" id="Monitor">Monitor</h2>
<hr />

<p>Monitor provides the abiliy to set monitors on data in a PVRecord. What
triggers a monitor depends on the monitor support in the server. The standard
server provides support for the following: onPut, onChange, onAbsoluteChange,
and onPercentChange.</p>

<p>A Monitor is created via a call to:</p>
<pre>    void createMonitor(
        MonitorRequester monitorRequester,
        PVStructure pvRequest);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">monitorRequester</span></dt>
    <dd>Described next.</dd>
  <dt><span style="font-family: Courier">pvRequest</span></dt>
    <dd>This is defined by pvCopy and pvMonitor. See their package overviews
      for details (org.epics.pvData.pvCopy and org.epics.pvData.pvMonitor).
      The format of the request for CreateRequest.createRequest has the form
      "record[options]field(fieldOptions)". Note that you can specify monitor
      options for individual fields. See the package overview for pvMonitor
      for details.</dd>
</dl>

<p>The requester must implement the interface.</p>
<pre>interface MonitorRequester extends Requester{
    void monitorConnect(Monitor monitor);
    void monitorEvent((Monitor monitor);
    void unlisten();
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">monitorConnect</span></dt>
    <dd>This is called if the createMonitor fails or when the client request
      is connected to the server. Status provides the result of the
      createMonitor request. If status is not success than the other
      arguments are null. monitor is the interface for the Monitor</dd>
  <dt><span style="font-family: Courier">monitorEvent</span></dt>
    <dd>monitorEvent is called when a monitor occurs. The client must call
      monitor.poll to get data for the monitor. See below. </dd>
  <dt><span style="font-family: Courier">unlisten</span></dt>
    <dd>The server has issued an unlisten request.</dd>
</dl>

<p>The following is the Monitor interface which is defined in project
pvData</p>
<pre>interface Monitor extends Destroyable {
    void start();
    void stop();
    MonitorElement poll();
    void release(MonitorElement monitorElement);
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">start</span></dt>
    <dd>Start monitoring</dd>
  <dt><span style="font-family: Courier">stop</span></dt>
    <dd>Stop monitoring</dd>
  <dt><span style="font-family: Courier">poll</span></dt>
    <dd>Poll for monitor event. Null is returned when no more events are
      available. The client must call this method in order to get monitor
      data.</dd>
  <dt><span style="font-family: Courier">release</span></dt>
    <dd>When the client has processed the monitor event returned by poll the
      client must call release before again calling poll.</dd>
</dl>

<p>A monitorElement is defined as:</p>
<pre>interface MonitorElement {
    PVStructure getPVStructure();
    BitSet getChangedBitSet();
    BitSet getOverrunBitSet();
}</pre>

<p>where</p>
<dl>
  <dt><span style="font-family: Courier">getPVStructure</span></dt>
    <dd>The data structure.</dd>
  <dt><span style="font-family: Courier">getChangedBitSet</span></dt>
    <dd>A bitset which has a bit set for each field of the data structure
      which has changed since the last monitor.</dd>
  <dt><span style="font-family: Courier">getOverrunBitSet</span></dt>
    <dd>A bitset which has a bit set for each field of the data structure
      which has changed more than once since the last monitor.</dd>
</dl>
</body>
</html>
