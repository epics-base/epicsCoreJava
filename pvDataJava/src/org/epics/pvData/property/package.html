<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>EPICS PVData: property</title>
</head>

<body>
<h1 style="text-align: center">EPICS PVData: property<br />
package: org.epics.pvData.property<br />
2009.06.24</h1>
CONTENTS 

<div class="toc">
<ul>
  <li><a href="#Definition">Definition of Property</a></li>
  <li><a href="#Standard">Standard Properties</a></li>
  <li><a href="#PVProperty">PVProperty</a></li>
  <li><a href="#Standard1">Standard Properties</a> 
    <ul>
      <li><a href="#TimeStamp">TimeStamp</a></li>
      <li><a href="#Alarm">Alarm</a></li>
      <li><a href="#Limits">Limits</a></li>
      <li><a href="#Display">Display</a></li>
      <li><a href="#Control">Control</a></li>
    </ul>
  </li>
  <li><a href="#Interfaces">Interfaces for Standard Properties</a> 
    <ul>
      <li><a href="#TimeStamp1">TimeStamp</a></li>
      <li><a href="#Alarm1">Alarm</a></li>
    </ul>
  </li>
</ul>
</div>
<hr />

<h2 style="text-align: center" id="Definition">Definition of Property</h2>
<hr />

<p>Only fields named "value" have properties. A record can have multiple
value fields, which can appear in the top level structure of a record or in a
substructure. All other fields in the structure containing a value field are
considered properties of the value field. The fieldname is also the property
name. The value field can have any type, i.e. scalar, scalarArray, or
structure. Typical property fields are timeStamp, alarm, display, control,
and history.</p>

<p>The timeStamp is a special case. If it appears anywhere in the structure
hieraracy above a value field it is a property of the value field.</p>

<p>For example the following record has a single value field. The value field
has propertys alarm, timeStamp, and display.</p>
<pre>&lt;record name = "counterOutput" &gt;
    &lt;structure name = "alarm" extends = "alarm" /&gt;
    &lt;structure name = "timeStamp" extends = "timeStamp" /&gt;
    &lt;scalar name = "value" scalarType = "double" /&gt;
    &lt;structure name = "display" extends = "display" &gt;
        &lt;scalar name = "description"&gt;Sample Description&lt;/scalar&gt;
        &lt;scalar name = "format"&gt;%f&lt;/scalar&gt;
        &lt;scalar name = "resolution"&gt;1&lt;/scalar&gt;
        &lt;scalar name = "units"&gt;volts&lt;/scalar&gt;
        &lt;structure name = "limit"&gt;
            &lt;scalar name ="low"&gt;0.0&lt;/scalar&gt;
            &lt;scalar name ="high"&gt;10.0&lt;/scalar&gt;
        &lt;/structure&gt;
    &lt;/structure&gt;
&lt;/record&gt;</pre>

<p>The following example has three value fields each with properties alarm
and timeStamp. Voltage, Current, and Power each have a different alarms but
all share the timeStamp.</p>
<pre>&lt;record name = "psSimple"&gt;
    &lt;structure name = "alarm" extends = "alarm" /&gt;
    &lt;structure name = "timeStamp" extends = "timeStamp" /&gt;
    &lt;structure name = "voltage"&gt;
        &lt;scalar name = "value" scalarType = "double" /&gt;
        &lt;structure name = "alarm" extends = "alarm" /&gt;
    &lt;/structure&gt;
    &lt;structure name = "current"&gt;
        &lt;scalar name = "value" scalarType = "double" /&gt;
        &lt;structure name = "alarm" extends = "alarm" /&gt;
    &lt;/structure&gt;
    &lt;structure name = "power"&gt;
        &lt;scalar name = "value" scalarType = "double" /&gt;
        &lt;structure name = "alarm" extends = "alarm" /&gt;
    &lt;/structure&gt;
&lt;/record&gt;</pre>
<hr />

<h2 style="text-align: center" id="Standard">Standard Properties</h2>
<hr />

<p>The following field names have special meaning, i.e. support properties
for general purpose clients.</p>
<dl>
  <dt>value</dt>
    <dd>This is normally defined since most general purpose clients access
      this field. All other fields in the structure support or describe the
      value field. The type can any supported type but is usually one of the
      following: 
      <dl>
        <dt>scalar</dt>
          <dd>One of boolean, byte, short, int, long, float, double, or
          string</dd>
        <dt>scalarArray</dt>
          <dd>An array with the elementType being a scalar type</dd>
        <dt>enumerated structure</dt>
          <dd>A structure that includes fields named index, choice, and
            choices. index is an int that selects a choice. choice is the
            currently selected choice. choices is an array of strings that
            defines the complete set of choices.</dd>
        <dt>other</dt>
          <dd>Other structure or array types can also be defined if clients
            and support code agree on the meaning. Some examples are: 1) A
            structure defining a 2D matrix, 2) A structure defining an image,
            3) A structure that simulates a remote method, ...</dd>
      </dl>
    </dd>
  <dt>timeStamp</dt>
    <dd>The timeStamp. The type MUST be a timeStamp structure. Also if the
      PVData structure does not have a timeStamp then a search up the parent
      tree is made to find a timeStamp.</dd>
  <dt>alarm</dt>
    <dd>The alarm. The type MUST be an alarm structure. </dd>
  <dt>display</dt>
    <dd>A display structure as described below. It provides display
      characteristics for the value field.</dd>
  <dt>control</dt>
    <dd>A control structure as described below. It provides control
      characteristics for the value field.</dd>
  <dt>history</dt>
    <dd>Provides a history buffer for the value field. Note that currently
      PVData does not define history suppoprt.</dd>
  <dt>other</dt>
    <dd>Other standard properties can be defined.</dd>
</dl>

<p>In addition a structure can have additional fields that support the value
field but are not recognized by most general purpose client tools. Typical
examples are:</p>
<dl>
  <dt>input</dt>
    <dd>A field with support that changes the value field. This can be
      anything. It can be a channel access link. It can obtain a value from
      hardware. Etc.</dd>
  <dt>valueAlarm</dt>
    <dd>A field with support that looks for alarm conditions based on the
      value.</dd>
  <dt>output</dt>
    <dd>A field with support that reads the current value and sends it
      somewhere else. This can be anything. It can be a channel access link.
      It can write a value to hardware. Etc.</dd>
</dl>

<p>The model allows for device records. A device record has fields that are
structures that support the PVData data model. For example a powerSupport
record can have fields power, voltage, current that each support the PVData
data model. </p>
<hr />

<h2 style="text-align: center" id="PVProperty">PVProperty</h2>
<hr />

<p>Interface and factory for finding a field within a structure.</p>
<pre>    public interface PVProperty {
        PVField findProperty(PVField pvField,String fieldName);
        PVField findPropertyViaParent(PVField pvField,String propertyName);
        String[] getPropertyNames(PVField pvField);
    }

    public class PVPropertyFactory {
         public static PVProperty getPVProperty();
    }</pre>
<ul>
  <li>findProperty<br />
    Find a field that is a subfield or property of this PVField. The
    fieldName is of the form name.name... The pvField must be named value or
    it does not have properties. </li>
  <li>findPropertyViaParent<br />
    Find a property by searching up the parent tree. The property name is
    expected to match the name of a field. The return value is the interface
    to the first field found that is not a null structure or null if not
    found. </li>
  <li>getPropertyNames<br />
    Get a String array that holds the names of the properties for this field.
  </li>
  <li>getPVProperty<br />
    Get the single instance of PVProperty. </li>
</ul>
<hr />

<h2 style="text-align: center" id="Standard1">Standard Properties</h2>
<hr />

<p>This section has structure definitions that support standard
properties.</p>

<h3 id="TimeStamp">TimeStamp</h3>
<pre>&lt;structure name = "timeStamp"&gt;
  &lt;scalar name = "secondsPastEpoch" scalarType = "long" /&gt;
  &lt;scalar name = "nanoSeconds" scalarType = "int" /&gt;
&lt;/structure&gt;</pre>

<h3 id="Alarm">Alarm</h3>
<pre>&lt;structure name = "alarmSeverity" extends = "enumerated" &gt;
  &lt;array name = "choices"  immutable = "true" &gt;none,minor,major,invalid&lt;/array&gt;
&lt;/structure&gt;

&lt;structure name = "alarm"&gt;
  &lt;structure name = "severity" extends = "alarmSeverity" /&gt;
  &lt;scalar name = "message" scalarType = "string" /&gt;
  &lt;scalar name = "ackTransient" scalarTan" /&gt;
  &lt;structure nameype = "boolean" /&gt;
  &lt;structure name = "ackSeverity" extends = "alarmSeverity" /&gt;
&lt;/structure&gt;</pre>

<h3 id="Limits">Limits</h3>
<pre>&lt;structure name = "byteLimit"&gt;
    &lt;scalar name = "low" scalarType = "byte" /&gt;
    &lt;scalar name = "high" scalarType = "byte" /&gt;
&lt;/structure&gt;

&lt;structure name = "shortLimit"&gt;
    &lt;scalar name = "low" scalarType = "short" /&gt;
    &lt;scalar name = "high" scalarType = "short" /&gt;
&lt;/structure&gt;

&lt;structure name = "intLimit"&gt;
    &lt;scalar name = "low" scalarType = "int" /&gt;
    &lt;scalar name = "high" scalarType = "int" /&gt;
&lt;/structure&gt;

&lt;structure name = "longLimit"&gt;
    &lt;scalar name = "low" scalarType = "long" /&gt;
    &lt;scalar name = "high" scalarType = "long" /&gt;
&lt;/structure&gt;

&lt;structure name = "floatLimit"&gt;
    &lt;scalar name = "low" scalarType = "float" /&gt;
    &lt;scalar name = "high" scalarType = "float" /&gt;
&lt;/structure&gt;

&lt;structure name = "doubleLimit"&gt;
    &lt;scalar name = "low" scalarType = "double" /&gt;
    &lt;scalar name = "high" scalarType = "double" /&gt;
&lt;/structure&gt;</pre>

<h3 id="Display">Display</h3>
<pre>&lt;structure name = "display"&gt;
    &lt;scalar name = "description" scalarType = "string" /&gt;
    &lt;scalar name = "format" scalarType = "string" /&gt;
    &lt;scalar name = "units" scalarType = "string" /&gt;
    &lt;scalar name = "resolution" scalarType = "int" /&gt;
    &lt;structure name = "limit" extends = "doubleLimit" /&gt;
&lt;/structure&gt;</pre>

<h3 id="Control">Control</h3>
<pre>&lt;structure name = "control"&gt;
    &lt;structure name = "limit" extends = "doubleLimit" /&gt;
    &lt;scalar name = "minStep" scalarType = "double" /&gt;
&lt;/structure&gt;</pre>
<hr />

<h2 style="text-align: center" id="Interfaces">Interfaces for Standard
Properties</h2>
<hr />

<h3 id="TimeStamp1">TimeStamp</h3>

<p>The following priovides convient access to a timeStamp structure.</p>
<pre>interface TimeStamp {
    long getSecondsPastEpoch();
    int getNanoSeconds();
    void put(long secondsPastEpoch,int nanoSeconds);
    long getMilliSeconds();
    void put(long milliSeconds);
}

class TimeStampFactory{
    public static TimeStamp create(long secondsPastEpoch,int nanoSeconds);
    // following returns null if pvStructure is not a timeStamp structure.
    public static TimeStamp getTimeStamp(PVStructure pvStructure);</pre>

<h3 id="Alarm1">Alarm</h3>

<p>The following provides convient access to the fields of an alarm
structure.</p>
<pre>interface Alarm {
    PVString getAlarmMessage();
    PVInt getAlarmSeverityIndex();
    String getAlarmSeverityChoice();
    PVStringArray getAlarmSeverityChoices();
    PVBoolean getAckTransient();
    PVInt getAckAlarmSeverityIndex();
    String getAckAlarmSeverityChoice();
    PVStringArray getAckAlarmSeverityChoices();
}

class AlarmFactory {
    // returns null if pvField is not an alarm structure.
    public static Alarm getAlarm(PVField pvField);
}</pre>
</body>
</html>
